{% load socialaccount %}
{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="description" content="Sign in to VisMatrix.Space - Track your progress with friends">
  <meta name="theme-color" content="#1d4ed8">
  <title>Login - VisMatrix.Space</title>

  <!-- App Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'branding/vismatrixicon.png' %}">

  <!-- Tailwind + DaisyUI + Bootstrap Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <style>
    /* Login page specific styles - matches base.html design system */
    .login-hero {
      background: linear-gradient(135deg, rgb(248 250 252 / 0.9) 0%, rgb(241 245 249 / 0.7) 100%);
      backdrop-filter: blur(20px);
    }
    
    .login-card {
      background: rgb(255 255 255 / 0.98);
      border: 1px solid rgb(226 232 240 / 0.8);
      box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.1);
    }
    
    .login-header {
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
    }
    
    /* Animations matching base.html */
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    }
    
    /* Enhanced focus states for inputs */
    .input:focus {
      border-color: rgb(29 78 216);
      box-shadow: 0 0 0 3px rgb(29 78 216 / 0.25);
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center p-4 lg:p-8 login-hero">
  

  <main id="main-login" class="w-full max-w-md login-card rounded-3xl overflow-hidden animate-slideUp" role="main" aria-labelledby="login-title">
    
    <!-- Header -->
    <div class="login-header text-white p-8 lg:p-12 text-center relative overflow-hidden">
      <div class="w-20 h-20 lg:w-24 lg:h-24 mx-auto mb-8 bg-white/20 rounded-2xl flex items-center justify-center shadow-2xl ring-2 ring-white/30">
        <i class="bi bi-graph-up-arrow text-3xl lg:text-4xl" aria-hidden="true"></i>
      </div>
      <h1 id="login-title" class="text-3xl lg:text-4xl font-black tracking-tight mb-4">
        Welcome Back!
      </h1>
      <p class="text-xl font-semibold text-slate-200 mb-6 opacity-90">
        Sign in to your VisMatrix.Space account
      </p>
      <div class="inline-block bg-emerald-400/90 text-emerald-900 px-6 py-3 rounded-2xl font-bold text-sm shadow-lg border border-emerald-300/50 tracking-wide">
        Agentic AI arrives March 2026
      </div>
    </div>

    <div class="p-8 lg:p-10 space-y-6">
      <!-- Social Login -->
      {% get_providers as socialaccount_providers %}
      {% if socialaccount_providers %}
      <div class="card-compact p-0">
        <a href="{% provider_login_url 'google' %}"
           class="btn btn-outline w-full gap-3 normal-case h-14 border-slate-200 hover:border-slate-300 hover:bg-slate-50 shadow-sm hover:shadow-md transition-all duration-200 text-base font-semibold"
           role="button" aria-label="Continue with Google account">
          <i class="bi bi-google text-xl" aria-hidden="true"></i>
          <span>Continue with Google</span>
        </a>
      </div>

      <div class="divider text-sm text-slate-500 before:bg-slate-200 after:bg-slate-200">or use email</div>
      {% endif %}

      <!-- Error alerts -->
      {% if form.non_field_errors %}
      <div class="alert alert-error shadow-lg">
        <i class="bi bi-exclamation-triangle-fill flex-shrink-0"></i>
        <span>{% for error in form.non_field_errors %}{{ error }}{% endfor %}</span>
      </div>
      {% endif %}

      <!-- Login Form -->
      <form method="post" class="space-y-6" novalidate role="form">
        {% csrf_token %}
        
        <!-- Username/Email Field -->
        <div class="form-control w-full">
          <label for="{{ form.login.id_for_label }}" class="label">
            <span class="label-text font-semibold text-base">Email or Username</span>
          </label>
          {% render_field form.login class="input input-bordered w-full h-14 text-base leading-relaxed lg:input-lg" placeholder="Enter email or username" autocomplete="username email" %}
          {% if form.login.errors %}
          <label class="label">
            <span class="label-text-alt text-error">{{ form.login.errors|first }}</span>
          </label>
          {% endif %}
        </div>

        <!-- Password Field -->
        <div class="form-control w-full">
          <label for="{{ form.password.id_for_label }}" class="label">
            <span class="label-text font-semibold text-base">Password</span>
          </label>
          {% render_field form.password class="input input-bordered w-full h-14 text-base leading-relaxed lg:input-lg" placeholder="Enter your password" autocomplete="current-password" %}
          {% if form.password.errors %}
          <label class="label">
            <span class="label-text-alt text-error">{{ form.password.errors|first }}</span>
          </label>
          {% endif %}
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary w-full h-14 text-lg font-bold shadow-lg hover:shadow-xl gap-3 lg:btn-lg">
          <i class="bi bi-box-arrow-in-right" aria-hidden="true"></i>
          <span>Sign In</span>
        </button>
      </form>

      <!-- Help links -->
      <div class="text-center space-y-3 pt-6 border-t border-slate-200">
        <p class="text-sm text-slate-600">
          <a href="#" class="link link-hover font-semibold text-slate-900 hover:text-primary">Forgot password?</a>
        </p>
        <p class="text-sm text-slate-600">
          Don't have an account? 
          <a href="{% url 'account_signup' %}" class="link link-hover font-bold text-primary">Create one now</a>
        </p>
      </div>
    </div>
  </main>

  <script>
    // Auto-focus first field and enhance accessibility
    document.addEventListener('DOMContentLoaded', () => {
      const firstField = document.querySelector('input[type="text"], input[type="email"]');
      if (firstField) firstField.focus();
      
      // Auto-dismiss alerts after 8s
      setTimeout(() => {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(alert => {
          alert.style.transition = 'opacity 0.5s';
          alert.style.opacity = '0';
          setTimeout(() => alert.remove(), 500);
        });
      }, 8000);
    });
  </script>
</body>
</html>
