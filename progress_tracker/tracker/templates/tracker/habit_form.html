{% extends 'tracker/base.html' %}

{% block title %}{{ action }} Habit - VisMatrix{% endblock %}

{% block content %}

<main class="max-w-3xl mx-auto space-y-6">
  <!-- Header -->
  <header class="card border border-base-200 bg-gradient-to-br from-success/5 via-base-100 to-info/5 shadow-lg">
    <div class="card-body p-6">
      <h1 class="text-3xl font-black text-base-content">
        <i class="bi bi-repeat text-success"></i> {{ action }} Habit
      </h1>
      <p class="text-sm text-base-content/70 mt-2">
        Create a recurring task to build consistency
      </p>
    </div>
  </header>

  <!-- Form -->
  <div class="card border border-base-200 bg-base-100 shadow-lg">
    <div class="card-body p-6">
      <form method="post" class="space-y-5">
        {% csrf_token %}

        <!-- Title -->
        <div class="form-control">
          <label class="label" for="{{ form.title.id_for_label }}">
            <span class="label-text font-semibold">
              <i class="bi bi-type"></i> Title
              <span class="text-error">*</span>
            </span>
          </label>
          {{ form.title }}
          {% if form.title.errors %}
            <label class="label">
              <span class="label-text-alt text-error">{{ form.title.errors.0 }}</span>
            </label>
          {% endif %}
          <label class="label">
            <span class="label-text-alt">Give your habit a clear, descriptive name</span>
          </label>
        </div>

        <!-- Description -->
        <div class="form-control">
          <label class="label" for="{{ form.description.id_for_label }}">
            <span class="label-text font-semibold">
              <i class="bi bi-text-paragraph"></i> Description
            </span>
          </label>
          {{ form.description }}
          {% if form.description.errors %}
            <label class="label">
              <span class="label-text-alt text-error">{{ form.description.errors.0 }}</span>
            </label>
          {% endif %}
          <label class="label">
            <span class="label-text-alt">Optional: Add details about this habit</span>
          </label>
        </div>

        <!-- Frequency -->
        <div class="form-control">
          <label class="label" for="{{ form.frequency.id_for_label }}">
            <span class="label-text font-semibold">
              <i class="bi bi-arrow-repeat"></i> Frequency
              <span class="text-error">*</span>
            </span>
          </label>
          {{ form.frequency }}
          {% if form.frequency.errors %}
            <label class="label">
              <span class="label-text-alt text-error">{{ form.frequency.errors.0 }}</span>
            </label>
          {% endif %}
          <label class="label">
            <span class="label-text-alt">How often should you complete this habit?</span>
          </label>
        </div>

        <!-- Category and Priority (Side by side) -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
          <!-- Category -->
          <div class="form-control">
            <label class="label" for="{{ form.category.id_for_label }}">
              <span class="label-text font-semibold">
                <i class="bi bi-tag"></i> Category
              </span>
            </label>
            {{ form.category }}
            {% if form.category.errors %}
              <label class="label">
                <span class="label-text-alt text-error">{{ form.category.errors.0 }}</span>
              </label>
            {% endif %}
            <label class="label">
              <span class="label-text-alt">Optional: Auto-detect or choose</span>
            </label>
          </div>

          <!-- Priority -->
          <div class="form-control">
            <label class="label" for="{{ form.priority.id_for_label }}">
              <span class="label-text font-semibold">
                <i class="bi bi-flag"></i> Priority
              </span>
            </label>
            {{ form.priority }}
            {% if form.priority.errors %}
              <label class="label">
                <span class="label-text-alt text-error">{{ form.priority.errors.0 }}</span>
              </label>
            {% endif %}
            <label class="label">
              <span class="label-text-alt">How important is this habit?</span>
            </label>
          </div>
        </div>

        <!-- Start Date -->
        <div class="form-control">
          <label class="label" for="{{ form.start_date.id_for_label }}">
            <span class="label-text font-semibold">
              <i class="bi bi-calendar-check"></i> Start Date
            </span>
          </label>
          {{ form.start_date }}
          {% if form.start_date.errors %}
            <label class="label">
              <span class="label-text-alt text-error">{{ form.start_date.errors.0 }}</span>
            </label>
          {% endif %}
          <label class="label">
            <span class="label-text-alt">When should this habit start?</span>
          </label>
        </div>

        <!-- Info Box -->
        <div class="alert alert-info shadow-md">
          <i class="bi bi-info-circle text-xl"></i>
          <div>
            <h3 class="font-bold">ðŸ’¡ About Habits</h3>
            <div class="text-sm">
              Habits don't have due dates - they repeat based on frequency. Track your consistency and build streaks!
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex flex-wrap gap-3 pt-4">
          <button type="submit" class="btn btn-success gap-2 shadow-md hover:shadow-lg">
            <i class="bi bi-check-lg"></i>
            <span>{{ action }} Habit</span>
          </button>
          <a href="{% url 'habit_list' %}" class="btn btn-ghost gap-2">
            <i class="bi bi-x-lg"></i>
            <span>Cancel</span>
          </a>
        </div>
      </form>
    </div>
  </div>
</main>

{% endblock %}
