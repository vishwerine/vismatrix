{% extends 'tracker/base.html' %}
{% load widget_tweaks %}  <!-- ADD THIS LINE -->
{% block content %}
<div class="max-w-2xl mx-auto px-6 py-12">
  <!-- Hero Header -->
  <div class="text-center mb-16">
    <div class="w-24 h-24 mx-auto mb-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-3xl flex items-center justify-center text-white shadow-2xl border-8 border-white/50">
      <i class="bi bi-clipboard-check text-4xl"></i>
    </div>
    <h1 class="text-5xl font-black text-slate-900 mb-4 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-700 bg-clip-text text-transparent">
      {{ title }}
    </h1>
    <p class="text-xl text-slate-600 max-w-xl mx-auto leading-relaxed">
      Create or update your task with all the important details
    </p>
  </div>

  <form method="post" class="space-y-10">
    {% csrf_token %}
    
    <!-- Task Title -->
    <div class="form-group">
      <label for="{{ form.title.id_for_label }}" class="block text-lg font-bold text-slate-900 mb-4 tracking-wide uppercase">
        Task Title
      </label>
      <div class="relative">
        {{ form.title|add_class:"w-full px-6 py-6 text-xl border-2 border-slate-200 rounded-3xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100/50 focus:outline-none shadow-lg hover:border-slate-300 hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-slate-50 to-white font-semibold" }}
        {% if form.title.errors %}
        <div class="mt-3 p-4 bg-red-50 border-2 border-red-200 rounded-2xl">
          <ul class="text-red-800 text-sm space-y-1">
            {% for error in form.title.errors %}
            <li><i class="bi bi-exclamation-circle-fill mr-2"></i>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>

    <!-- Description -->
    {% if form.description %}
    <div class="form-group">
      <label for="{{ form.description.id_for_label }}" class="block text-lg font-bold text-slate-900 mb-4 tracking-wide uppercase">
        Description (optional)
      </label>
      <div class="relative">
        {{ form.description|add_class:"w-full px-6 py-6 text-xl border-2 border-slate-200 rounded-3xl focus:border-emerald-500 focus:ring-4 focus:ring-emerald-100/50 focus:outline-none shadow-lg hover:border-slate-300 hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-slate-50 to-white resize-vertical min-h-[120px]" }}
        {% if form.description.errors %}
        <div class="mt-3 p-4 bg-red-50 border-2 border-red-200 rounded-2xl">
          <ul class="text-red-800 text-sm space-y-1">
            {% for error in form.description.errors %}
            <li><i class="bi bi-exclamation-circle-fill mr-2"></i>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    <!-- Priority -->
    {% if form.priority %}
    <div class="form-group">
      <label for="{{ form.priority.id_for_label }}" class="block text-lg font-bold text-slate-900 mb-4 tracking-wide uppercase">
        Priority Level
      </label>
      <div class="relative">
        {{ form.priority|add_class:"w-full px-6 py-6 text-xl border-2 border-slate-200 rounded-3xl focus:border-orange-500 focus:ring-4 focus:ring-orange-100/50 focus:outline-none shadow-lg hover:border-slate-300 hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-slate-50 to-white" }}
        {% if form.priority.errors %}
        <div class="mt-3 p-4 bg-red-50 border-2 border-red-200 rounded-2xl">
          <ul class="text-red-800 text-sm space-y-1">
            {% for error in form.priority.errors %}
            <li><i class="bi bi-exclamation-circle-fill mr-2"></i>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    <!-- Category -->
    {% if form.category %}
    <div class="form-group">
      <label for="{{ form.category.id_for_label }}" class="block text-lg font-bold text-slate-900 mb-4 tracking-wide uppercase">
        Category
      </label>
      <div class="relative">
        {{ form.category|add_class:"w-full px-6 py-6 text-xl border-2 border-slate-200 rounded-3xl focus:border-purple-500 focus:ring-4 focus:ring-purple-100/50 focus:outline-none shadow-lg hover:border-slate-300 hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-slate-50 to-white" }}
        {% if form.category.errors %}
        <div class="mt-3 p-4 bg-red-50 border-2 border-red-200 rounded-2xl">
          <ul class="text-red-800 text-sm space-y-1">
            {% for error in form.category.errors %}
            <li><i class="bi bi-exclamation-circle-fill mr-2"></i>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    <!-- Due Date -->
    {% if form.due_date %}
    <div class="form-group">
      <label for="{{ form.due_date.id_for_label }}" class="block text-lg font-bold text-slate-900 mb-4 tracking-wide uppercase">
        Due Date (optional)
      </label>
      <div class="relative">
        {{ form.due_date|add_class:"w-full px-6 py-6 text-xl border-2 border-slate-200 rounded-3xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100/50 focus:outline-none shadow-lg hover:border-slate-300 hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-slate-50 to-white font-mono tracking-wider" }}
        {% if form.due_date.errors %}
        <div class="mt-3 p-4 bg-red-50 border-2 border-red-200 rounded-2xl">
          <ul class="text-red-800 text-sm space-y-1">
            {% for error in form.due_date.errors %}
            <li><i class="bi bi-exclamation-circle-fill mr-2"></i>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="flex flex-col lg:flex-row gap-6 pt-12 border-t-4 border-slate-200">
      <button type="submit"
              class="flex-1 inline-flex items-center justify-center gap-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white px-12 py-8 rounded-3xl text-2xl font-black shadow-3xl hover:shadow-4xl hover:from-indigo-700 hover:to-purple-800 focus:outline-none focus:ring-4 focus:ring-indigo-500/50 focus:ring-offset-2 focus:ring-offset-white transform hover:-translate-y-2 transition-all duration-400 active:scale-95">
        <i class="bi bi-check-circle-fill text-3xl"></i>
        <span>Save Task</span>
      </button>
      
      <a href="{% url 'task_list' %}"
         class="flex-1 inline-flex items-center justify-center gap-4 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-900 px-12 py-8 rounded-3xl text-2xl font-black border-4 border-slate-300 hover:border-slate-400 hover:shadow-3xl hover:from-slate-200 hover:to-slate-300 focus:outline-none focus:ring-4 focus:ring-slate-500/50 focus:ring-offset-2 focus:ring-offset-white transform hover:-translate-y-2 transition-all duration-400 active:scale-95">
        <i class="bi bi-arrow-left text-3xl"></i>
        <span>Cancel</span>
      </a>
    </div>
  </form>

  <!-- Task Tips -->
  <div class="mt-20 p-12 bg-gradient-to-r from-emerald-50 to-blue-50 border-4 border-emerald-200 rounded-4xl shadow-2xl">
    <div class="flex items-start gap-6 mb-8">
      <div class="w-20 h-20 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl flex items-center justify-center text-white shadow-2xl flex-shrink-0 mt-1">
        <i class="bi bi-lightbulb-fill text-3xl"></i>
      </div>
      <div>
        <h3 class="text-4xl font-black text-emerald-900 mb-3">Pro Task Tips</h3>
        <p class="text-2xl text-emerald-800 font-semibold">Maximize your productivity</p>
      </div>
    </div>
    
    <div class="grid md:grid-cols-2 gap-8 text-lg">
      <div class="space-y-4 p-8 bg-white/80 backdrop-blur-sm rounded-3xl border-2 border-emerald-100 shadow-xl">
        <div class="flex items-start gap-4 p-6 bg-emerald-100/60 rounded-2xl border-l-6 border-emerald-400">
          <div class="w-12 h-12 bg-emerald-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl flex-shrink-0">1</div>
          <div>
            <h4 class="text-2xl font-bold text-slate-900 mb-2">Clear Titles</h4>
            <p class="text-slate-700 leading-relaxed">"Implement user auth" > "Work on backend"</p>
          </div>
        </div>
        <div class="flex items-start gap-4 p-6 bg-blue-100/60 rounded-2xl border-l-6 border-blue-400">
          <div class="w-12 h-12 bg-blue-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl flex-shrink-0">2</div>
          <div>
            <h4 class="text-2xl font-bold text-slate-900 mb-2">Set Deadlines</h4>
            <p class="text-slate-700 leading-relaxed">Due dates create urgency and focus</p>
          </div>
        </div>
      </div>
      
      <div class="space-y-4 p-8 bg-white/80 backdrop-blur-sm rounded-3xl border-2 border-emerald-100 shadow-xl">
        <div class="flex items-start gap-4 p-6 bg-purple-100/60 rounded-2xl border-l-6 border-purple-400">
          <div class="w-12 h-12 bg-purple-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl flex-shrink-0">3</div>
          <div>
            <h4 class="text-2xl font-bold text-slate-900 mb-2">Use Priorities</h4>
            <p class="text-slate-700 leading-relaxed">High = today, Medium = this week</p>
          </div>
        </div>
        <div class="flex items-start gap-4 p-6 bg-indigo-100/60 rounded-2xl border-l-6 border-indigo-400">
          <div class="w-12 h-12 bg-indigo-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl flex-shrink-0">4</div>
          <div>
            <h4 class="text-2xl font-bold text-slate-900 mb-2">Add Categories</h4>
            <p class="text-slate-700 leading-relaxed">Group by project or skill area</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Auto-focus title field and enhance UX
  document.addEventListener('DOMContentLoaded', function() {
    const titleInput = document.querySelector('input[name="title"]');
    if (titleInput) {
      titleInput.focus();
      
      // Limit title length with live counter
      titleInput.addEventListener('input', function() {
        const maxLength = 100;
        const remaining = maxLength - this.value.length;
        if (remaining < 10 && !this.parentElement.querySelector('.char-counter')) {
          const counter = document.createElement('div');
          counter.className = 'char-counter text-sm text-slate-500 mt-2 font-mono';
          counter.textContent = `${remaining} characters remaining`;
          this.parentElement.appendChild(counter);
        }
      });
    }
  });
</script>
{% endblock %}
