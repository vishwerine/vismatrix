{% extends 'tracker/base.html' %}

{% block title %}Pro Dashboard - VisMatrix{% endblock %}

{% block extra_head %}
<style>
  .pro-gradient {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }
  
  .feature-card {
    transition: all 0.3s ease;
    cursor: pointer;
  }
  
  .feature-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
  }
  
  .feature-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    font-size: 24px;
  }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 max-w-7xl">
  <!-- Header with Pro Badge -->
  <div class="pro-gradient rounded-2xl p-8 mb-6 text-white">
    <div class="flex items-center justify-between flex-wrap gap-4">
      <div>
        <div class="flex items-center gap-3 mb-2">
          <i class="bi bi-star-fill text-3xl"></i>
          <h1 class="text-4xl font-bold">VisMatrix Pro</h1>
        </div>
        <p class="text-white/90 text-lg">Unlock your full productivity potential</p>
      </div>
      <div class="text-right">
        <p class="text-white/90 text-sm">Subscription Status</p>
        <p class="text-2xl font-bold">{{ subscription.get_status_display }}</p>
        <p class="text-white/80 text-sm">{{ days_remaining }} days remaining</p>
      </div>
    </div>
  </div>

  <!-- Pro Features Grid -->
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-4">Your Pro Features</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      
      <!-- Advanced Analytics -->
      <a href="{% url 'advanced_analytics' %}" class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-primary/10 text-primary">
              <i class="bi bi-graph-up-arrow"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">Advanced Analytics</h3>
              <p class="text-sm text-base-content/70">Deep insights, trends, and predictions for your productivity</p>
            </div>
          </div>
        </div>
      </a>

      <!-- Data Export -->
      <div class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-success/10 text-success">
              <i class="bi bi-download"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">Data Export</h3>
              <p class="text-sm text-base-content/70 mb-3">Download your data in CSV format</p>
              <div class="flex gap-2 flex-wrap">
                <a href="{% url 'export_data_csv' %}?type=tasks" class="btn btn-xs btn-outline">Tasks</a>
                <a href="{% url 'export_data_csv' %}?type=logs" class="btn btn-xs btn-outline">Logs</a>
                <a href="{% url 'export_data_csv' %}?type=habits" class="btn btn-xs btn-outline">Habits</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- AI Categorization -->
      <div class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-secondary/10 text-secondary">
              <i class="bi bi-robot"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">AI Auto-Categorization</h3>
              <p class="text-sm text-base-content/70">Automatically categorize tasks using AI</p>
              <div class="badge badge-sm badge-secondary mt-2">Beta</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bulk Operations -->
      <div class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-warning/10 text-warning">
              <i class="bi bi-layers"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">Bulk Operations</h3>
              <p class="text-sm text-base-content/70">Edit, delete, or complete multiple tasks at once</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Unlimited History -->
      <div class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-info/10 text-info">
              <i class="bi bi-infinity"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">Unlimited History</h3>
              <p class="text-sm text-base-content/70">Access your complete task and log history</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Priority Support -->
      <div class="feature-card card bg-base-100 border border-base-200">
        <div class="card-body p-5">
          <div class="flex items-start gap-4">
            <div class="feature-icon bg-error/10 text-error">
              <i class="bi bi-headset"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-bold text-lg mb-1">Priority Support</h3>
              <p class="text-sm text-base-content/70">Get help faster with priority email support</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Subscription Details -->
    <div class="card bg-base-100 border border-base-200">
      <div class="card-body p-5">
        <h2 class="text-xl font-bold mb-4">Subscription Details</h2>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-base-content/70">Plan:</span>
            <span class="font-bold">Pro Monthly</span>
          </div>
          <div class="flex justify-between">
            <span class="text-base-content/70">Status:</span>
            <span class="badge badge-success">{{ subscription.get_status_display }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-base-content/70">Price:</span>
            <span class="font-bold">$20.00/month</span>
          </div>
          <div class="flex justify-between">
            <span class="text-base-content/70">Current Period:</span>
            <span class="text-sm">
              {{ subscription.current_period_start|date:"M d, Y" }} - {{ subscription.current_period_end|date:"M d, Y" }}
            </span>
          </div>
          <div class="flex justify-between">
            <span class="text-base-content/70">Renewal Date:</span>
            <span class="font-bold">{{ subscription.current_period_end|date:"M d, Y" }}</span>
          </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="flex gap-2">
          <a href="{% url 'subscription_plans' %}" class="btn btn-primary flex-1 gap-2">
            <i class="bi bi-credit-card"></i>
            Manage Subscription
          </a>
        </div>
      </div>
    </div>

    <!-- Payment History -->
    <div class="card bg-base-100 border border-base-200">
      <div class="card-body p-5">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-bold">Payment History</h2>
          <a href="{% url 'payment_history' %}" class="btn btn-sm btn-ghost gap-2">
            View All
            <i class="bi bi-arrow-right"></i>
          </a>
        </div>
        
        {% if payments %}
        <div class="space-y-3">
          {% for payment in payments %}
          <div class="flex items-center justify-between p-3 bg-base-200 rounded-lg">
            <div>
              <p class="font-medium">${{ payment.amount }}</p>
              <p class="text-xs text-base-content/70">{{ payment.created_at|date:"M d, Y" }}</p>
            </div>
            <span class="badge {% if payment.status == 'succeeded' %}badge-success{% else %}badge-error{% endif %}">
              {{ payment.get_status_display }}
            </span>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-8 text-base-content/70">
          <i class="bi bi-receipt text-4xl mb-2"></i>
          <p>No payment history yet</p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Usage Stats (Future Enhancement) -->
  <div class="card bg-base-100 border border-base-200 mt-6">
    <div class="card-body p-5">
      <h2 class="text-xl font-bold mb-4">Feature Usage</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="text-center">
          <p class="text-3xl font-bold text-primary">{{ total_exports }}</p>
          <p class="text-sm text-base-content/70">Data Exports</p>
        </div>
        <div class="text-center">
          <p class="text-3xl font-bold text-success">{{ total_bulk_ops }}</p>
          <p class="text-sm text-base-content/70">Bulk Operations</p>
        </div>
        <div class="text-center">
          <p class="text-3xl font-bold text-secondary">{{ total_ai_classifications }}</p>
          <p class="text-sm text-base-content/70">AI Classifications</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
