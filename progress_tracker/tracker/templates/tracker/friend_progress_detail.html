{% extends 'tracker/base.html' %}

{% block title %}{{ friend.username }}'s Progress - Progress Tracker{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-6 py-12">
  <!-- Hero Header -->
  <div class="text-center mb-20">
    <div class="inline-flex items-center justify-center w-32 h-32 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full shadow-2xl mb-8 border-8 border-white/50">
      <i class="bi bi-person-check-fill text-5xl text-white drop-shadow-lg"></i>
    </div>
    <h1 class="text-6xl font-black text-slate-900 mb-4 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-700 bg-clip-text text-transparent">
      {{ friend.username }}'s Progress
    </h1>
    <p class="text-2xl text-slate-600 max-w-2xl mx-auto leading-relaxed">
      Detailed view of completed tasks and activity logs
    </p>
  </div>

  <div class="grid lg:grid-cols-2 gap-12 mb-20">
    <!-- Completed Tasks Section -->
    <section class="bg-white shadow-2xl border border-slate-200 rounded-3xl p-12 hover:shadow-3xl transition-all duration-300 group">
      <div class="flex items-center gap-6 mb-10">
        <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-3xl flex items-center justify-center text-white shadow-2xl group-hover:scale-110 transition-transform duration-300">
          <i class="bi bi-check2-all text-3xl"></i>
        </div>
        <div>
          <h2 class="text-4xl font-black text-slate-900 mb-2">Completed Tasks</h2>
          <div class="h-1 w-24 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full shadow-lg"></div>
        </div>
      </div>

      {% if tasks %}
      <div class="space-y-4 max-h-96 overflow-y-auto pr-4 -mr-4 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100">
        {% for task in tasks %}
        <div class="task-item group/task bg-gradient-to-r from-slate-50 to-white border border-slate-200 hover:border-green-300 rounded-2xl p-8 hover:shadow-xl hover:-translate-y-2 transition-all duration-300 hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50">
          <div class="flex items-start justify-between gap-6">
            <div class="flex-1 min-w-0">
              <h4 class="text-2xl font-bold text-slate-900 group-hover/task:text-green-900 transition-colors mb-4 line-clamp-2">{{ task.title }}</h4>
              <div class="inline-flex items-center gap-3 px-6 py-3 bg-green-100 text-green-800 rounded-2xl font-semibold shadow-lg border border-green-200 text-lg">
                <i class="bi bi-check-lg text-xl"></i>
                <span>Completed</span>
              </div>
            </div>
            <div class="text-right flex-shrink-0">
              <div class="text-4xl font-black text-green-600 mb-2">{{ task.completed_at|date:"MMM d" }}</div>
              <div class="text-lg text-slate-500 font-semibold">{{ task.completed_at|date:"Y" }}</div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="mt-10 pt-10 border-t-2 border-slate-200 text-center">
        <p class="text-2xl font-black text-slate-900 mb-2">{{ tasks|length }} task{{ tasks|length|pluralize }} completed</p>
        <div class="inline-flex items-center gap-2 text-xl text-slate-600 font-semibold">
          <i class="bi bi-arrow-clockwise"></i>
          Showing recent activity
        </div>
      </div>
      {% else %}
      <div class="text-center py-24">
        <div class="w-32 h-32 mx-auto mb-8 bg-gradient-to-br from-green-100 to-emerald-100 rounded-3xl flex items-center justify-center border-4 border-dashed border-green-300 shadow-xl">
          <i class="bi bi-check-circle text-6xl text-green-400"></i>
        </div>
        <h3 class="text-4xl font-black text-slate-700 mb-6">No completed tasks</h3>
        <p class="text-2xl text-slate-600 max-w-lg mx-auto leading-relaxed">This user hasn't completed any tasks recently</p>
      </div>
      {% endif %}
    </section>

    <!-- Daily Logs Section -->
    <section class="bg-white shadow-2xl border border-slate-200 rounded-3xl p-12 hover:shadow-3xl transition-all duration-300 group">
      <div class="flex items-center gap-6 mb-10">
        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl flex items-center justify-center text-white shadow-2xl group-hover:scale-110 transition-transform duration-300">
          <i class="bi bi-journal-check text-3xl"></i>
        </div>
        <div>
          <h2 class="text-4xl font-black text-slate-900 mb-2">Daily Logs</h2>
          <div class="h-1 w-24 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full shadow-lg"></div>
        </div>
      </div>

      {% if logs %}
      <div class="space-y-4 max-h-96 overflow-y-auto pr-4 -mr-4 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100">
        {% for log in logs %}
        <div class="log-item group/log bg-gradient-to-r from-slate-50 to-white border border-slate-200 hover:border-blue-300 rounded-2xl p-8 hover:shadow-xl hover:-translate-y-2 transition-all duration-300 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50">
          <div class="flex items-start justify-between gap-6">
            <div class="flex-1 min-w-0">
              <h4 class="text-2xl font-bold text-slate-900 group-hover/log:text-blue-900 transition-colors mb-4 line-clamp-2">{{ log.activity }}</h4>
              <div class="inline-flex items-center gap-3 px-6 py-3 bg-blue-100 text-blue-800 rounded-2xl font-semibold shadow-lg border border-blue-200 text-lg">
                <i class="bi bi-stopwatch text-xl"></i>
                <span>{{ log.duration }} min</span>
              </div>
            </div>
            <div class="text-right flex-shrink-0">
              <div class="text-4xl font-black text-blue-600 mb-2">{{ log.date|date:"MMM d" }}</div>
              <div class="text-lg text-slate-500 font-semibold">{{ log.date|date:"Y" }}</div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="mt-10 pt-10 border-t-2 border-slate-200 text-center">
        <p class="text-2xl font-black text-slate-900 mb-2">{{ logs|length }} log{{ logs|length|pluralize }} recorded</p>
        <div class="inline-flex items-center gap-2 text-xl text-slate-600 font-semibold">
          <i class="bi bi-calendar3"></i>
          Recent activity shown
        </div>
      </div>
      {% else %}
      <div class="text-center py-24">
        <div class="w-32 h-32 mx-auto mb-8 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-3xl flex items-center justify-center border-4 border-dashed border-blue-300 shadow-xl">
          <i class="bi bi-journal-plus text-6xl text-blue-400"></i>
        </div>
        <h3 class="text-4xl font-black text-slate-700 mb-6">No daily logs</h3>
        <p class="text-2xl text-slate-600 max-w-lg mx-auto leading-relaxed">No activities have been logged recently</p>
      </div>
      {% endif %}
    </section>
  </div>

  <!-- Action Button -->
  <div class="text-center">
    <a href="{% url 'friend_progress_list' %}"
       class="inline-flex items-center gap-4 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-900 px-16 py-8 rounded-3xl text-2xl font-black border-4 border-slate-300 hover:border-slate-400 hover:shadow-2xl hover:from-slate-200 hover:to-slate-300 focus:outline-none focus:ring-4 focus:ring-slate-500/50 focus:ring-offset-2 focus:ring-offset-white transform hover:-translate-y-2 transition-all duration-300 shadow-xl group">
      <i class="bi bi-arrow-left text-3xl group-hover:-translate-x-1 transition-transform duration-300"></i>
      <span>Back to Friends Progress</span>
    </a>
  </div>
</div>

<style>
  /* Custom accessible scrollbar */
  .scrollbar-thin::-webkit-scrollbar {
    width: 8px;
  }
  .scrollbar-thin::-webkit-scrollbar-track {
    background: #f8fafc;
    border-radius: 4px;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: #e2e8f0;
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: content-box;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: #cbd5e1;
  }

  /* Line clamp utility */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
{% endblock %}
