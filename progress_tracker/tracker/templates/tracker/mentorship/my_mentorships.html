{% extends 'tracker/base.html' %}

{% block title %}My Mentorships - VisMatrix{% endblock %}

{% block content %}
<main class="container mx-auto px-4 py-6 max-w-4xl">
  <div class="mb-6">
    <h1 class="text-3xl font-bold mb-2">
      <i class="bi bi-people"></i>
      My Mentorships
    </h1>
    <p class="text-gray-600">Track your mentorship applications and active mentorships</p>
  </div>

  <!-- Quick Actions -->
  <div class="flex gap-2 mb-6">
    <a href="{% url 'mentor_list' %}" class="btn btn-primary btn-sm">
      <i class="bi bi-search"></i>
      Find a Mentor
    </a>
  </div>

  <!-- Mentorship Requests -->
  {% if my_requests %}
  <div class="space-y-4">
    {% for request in my_requests %}
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <div class="flex items-start gap-4">
          <div class="avatar placeholder">
            <div class="bg-primary text-primary-content rounded-full w-12">
              <span>{{ request.mentor_profile.user.username|first|upper }}</span>
            </div>
          </div>
          <div class="flex-1 min-w-0">
            <div class="flex items-center gap-2 mb-1">
              <h3 class="font-bold text-lg">{{ request.mentor_profile.user.username }}</h3>
              <span class="badge badge-sm badge-primary">{{ request.get_category_display }}</span>
            </div>

            <!-- Status Badge -->
            <div class="mb-2">
              {% if request.status == 'pending' %}
              <span class="badge badge-warning">Pending Review</span>
              {% elif request.status == 'accepted' %}
              <span class="badge badge-success">Accepted</span>
              {% elif request.status == 'rejected' %}
              <span class="badge badge-error">Declined</span>
              {% elif request.status == 'completed' %}
              <span class="badge badge-info">Completed</span>
              {% endif %}
            </div>

            <p class="text-sm text-gray-600 mb-2">Applied on {{ request.created_at|date:"M j, Y" }}</p>

            <!-- Your Message -->
            <div class="mb-3">
              <p class="text-sm font-semibold mb-1">Your message:</p>
              <p class="text-sm italic text-gray-700">{{ request.message }}</p>
            </div>

            <!-- Mentor Response -->
            {% if request.response_message %}
            <div class="alert alert-{% if request.status == 'accepted' %}success{% else %}info{% endif %} alert-sm">
              <div>
                <p class="text-sm font-semibold">Mentor's response:</p>
                <p class="text-sm">{{ request.response_message }}</p>
                <p class="text-xs text-gray-600 mt-1">{{ request.responded_at|date:"M j, Y" }}</p>
              </div>
            </div>
            {% endif %}

            <!-- Actions -->
            {% if request.status == 'accepted' %}
            <div class="mt-3">
              <a href="{% url 'mentor_profile' request.mentor_profile.id %}" class="btn btn-outline btn-sm">
                <i class="bi bi-person"></i>
                View Mentor Profile
              </a>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="card bg-base-100 shadow">
    <div class="card-body text-center py-12">
      <i class="bi bi-inbox text-4xl text-gray-400 mb-3"></i>
      <h3 class="font-bold text-lg mb-2">No Mentorships Yet</h3>
      <p class="text-gray-600 mb-4">Start your learning journey by connecting with a mentor.</p>
      <a href="{% url 'mentor_list' %}" class="btn btn-primary btn-sm">
        <i class="bi bi-search"></i>
        Find a Mentor
      </a>
    </div>
  </div>
  {% endif %}
</main>
{% endblock %}
