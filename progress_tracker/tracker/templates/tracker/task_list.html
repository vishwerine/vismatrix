{% extends 'tracker/base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto">
  <h1 class="text-3xl font-bold text-slate-900 dark:text-slate-50 mb-6">All Tasks</h1>

  <a href="{% url 'task_create' %}"
     class="inline-block rounded-lg bg-indigo-600 px-5 py-2 text-white font-semibold hover:bg-indigo-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 mb-6">
    Add New Task
  </a>

  <div class="flex flex-wrap gap-3 mb-6">
    <a href="?status=all"
       class="rounded-md border border-gray-300 dark:border-gray-600 px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-indigo-600 hover:text-white">
      All
    </a>
    <a href="?status=pending"
       class="rounded-md border border-gray-300 dark:border-gray-600 px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-indigo-600 hover:text-white">
      Pending
    </a>
    <a href="?status=in_progress"
       class="rounded-md border border-gray-300 dark:border-gray-600 px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-indigo-600 hover:text-white">
      In Progress
    </a>
    <a href="?status=completed"
       class="rounded-md border border-gray-300 dark:border-gray-600 px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-indigo-600 hover:text-white">
      Completed
    </a>
  </div>

  <div class="space-y-6">
    {% for task in tasks %}
    <article class="rounded-lg border-l-4 p-4 bg-gray-50 dark:bg-slate-800
                    {% if task.priority == 'high' %}border-rose-500{% elif task.priority == 'medium' %}border-amber-400{% else %}border-slate-400{% endif %}
                    {% if task.status == 'completed' %} opacity-70 line-through {% endif %}">
      <div class="flex justify-between items-start">
        <strong class="text-lg text-slate-900 dark:text-slate-50">{{ task.title }}</strong>
        <div class="flex space-x-3">
          {% if task.status != 'completed' %}
          <a href="{% url 'task_update' task.pk %}"
             class="rounded-md bg-gray-300 dark:bg-gray-700 px-3 py-1.5 text-sm font-medium hover:bg-gray-400 dark:hover:bg-gray-600">
            Edit
          </a>
          <a href="{% url 'task_complete' task.pk %}"
             class="rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500">
            Complete
          </a>
          {% endif %}
          <a href="{% url 'task_delete' task.pk %}"
             class="rounded-md bg-rose-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-rose-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500">
            Delete
          </a>
        </div>
      </div>
      <p class="mt-2 text-slate-700 dark:text-slate-300">{{ task.description }}</p>
      <small class="text-gray-600 dark:text-gray-400">
        Status: {{ task.get_status_display }} | Priority: {{ task.get_priority_display }} | Created: {{ task.created_at|date:"Y-m-d" }}
      </small>
    </article>
    {% empty %}
    <p class="text-center text-gray-500 dark:text-gray-400">No tasks found.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
